package net.frogmouth.rnd.jim.nitf;

import static org.testng.Assert.*;

import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.nio.file.Files;
import java.nio.file.StandardOpenOption;
import net.frogmouth.rnd.jim.nitf.des.DataExtensionSegment;
import net.frogmouth.rnd.jim.nitf.image.ImageCategory;
import net.frogmouth.rnd.jim.nitf.image.ImageCompression;
import net.frogmouth.rnd.jim.nitf.image.ImageRepresentation;
import net.frogmouth.rnd.jim.nitf.image.ImageSegment;
import net.frogmouth.rnd.jim.nitf.image.PixelValueType;
import net.frogmouth.rnd.jim.nitf.text.TextSegment;
import net.frogmouth.rnd.jim.nitf.tre.xmldca.XMLDCA;
import org.testng.annotations.Test;

public class WriterTest {

    public WriterTest() {}

    @Test
    public void fileHeader() throws IOException {
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        Nitf testNitf = new Nitf();
        Writer writer = new Writer();
        writer.write(testNitf, baos);
        assertEquals(
                baos.toByteArray(),
                new byte[] {
                    0x4e,
                    0x49,
                    0x54,
                    0x46,
                    0x30,
                    0x32,
                    0x2e,
                    0x31,
                    0x30,
                    0x30,
                    0x33,
                    0x42,
                    0x46,
                    0x30,
                    0x31,
                    0x4a,
                    0x49,
                    0x4d,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x32,
                    0x30,
                    0x32,
                    0x32,
                    0x31,
                    0x30,
                    0x30,
                    0x36,
                    0x30,
                    0x36,
                    0x30,
                    0x36,
                    0x35,
                    0x34,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x55,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    (byte) 0xFF,
                    (byte) 0xFF,
                    (byte) 0xFF,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    // File size
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x33,
                    0x38,
                    0x38,
                    // Header size
                    0x30,
                    0x30,
                    0x30,
                    0x33,
                    0x38,
                    0x38,
                    // Image segment count
                    0x30,
                    0x30,
                    0x30,
                    // Graphic segment count
                    0x30,
                    0x30,
                    0x30,
                    // Old symbol segment count
                    0x30,
                    0x30,
                    0x30,
                    // Text segment count
                    0x30,
                    0x30,
                    0x30,
                    // DES count
                    0x30,
                    0x30,
                    0x30,
                    // Reserved segment count
                    0x30,
                    0x30,
                    0x30,
                    // User defined header
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    // Extended header
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                });
        Files.write(
                new File("empty388.nitf").toPath(), baos.toByteArray(), StandardOpenOption.CREATE);
    }

    @Test
    public void imageSegment() throws IOException {
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        Nitf testNitf = new Nitf();
        ImageSegment imageSegment = new ImageSegment();
        imageSegment.setDateTime(new JBPDateTime(20, 22, 10, 21, null, null, null));
        imageSegment.setPixelValueType(PixelValueType.Integer);
        imageSegment.setImageRepresentation(ImageRepresentation.RGB);
        imageSegment.setImageCategory(ImageCategory.VIS);
        imageSegment.setActualBitsPerPixelPerBand(8);
        imageSegment.setImageCompression(ImageCompression.NonCompressed);
        testNitf.addImageSegment(imageSegment);
        Writer writer = new Writer();
        writer.write(testNitf, baos);
        assertEquals(
                baos.toByteArray(),
                new byte[] {
                    0x4e,
                    0x49,
                    0x54,
                    0x46,
                    0x30,
                    0x32,
                    0x2e,
                    0x31,
                    0x30,
                    0x30,
                    0x33,
                    0x42,
                    0x46,
                    0x30,
                    0x31,
                    0x4a,
                    0x49,
                    0x4d,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x32,
                    0x30,
                    0x32,
                    0x32,
                    0x31,
                    0x30,
                    0x30,
                    0x36,
                    0x30,
                    0x36,
                    0x30,
                    0x36,
                    0x35,
                    0x34,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x55,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    (byte) 0xFF,
                    (byte) 0xFF,
                    (byte) 0xFF,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    // File size
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x33,
                    0x38,
                    0x38,
                    // Header size
                    0x30,
                    0x30,
                    0x30,
                    0x33,
                    0x38,
                    0x38,
                    // Image segment count
                    0x30,
                    0x30,
                    0x31,
                    // Image segment lengths
                    // TODO: real lengths
                    0x30,
                    0x30,
                    0x30,
                    0x34,
                    0x33,
                    0x39,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    // Graphic segment count
                    0x30,
                    0x30,
                    0x30,
                    // Old symbol segment count
                    0x30,
                    0x30,
                    0x30,
                    // Text segment count
                    0x30,
                    0x30,
                    0x30,
                    // DES count
                    0x30,
                    0x30,
                    0x30,
                    // Reserved segment count
                    0x30,
                    0x30,
                    0x30,
                    // User defined header
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    // Extended header
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    // TODO: remainder of image segment header
                    0x49,
                    0x4D,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20, // offset 415
                    0x32,
                    0x30,
                    0x32,
                    0x32,
                    0x31,
                    0x30,
                    0x32,
                    0x31,
                    0x2d,
                    0x2d,
                    0x2d,
                    0x2d,
                    0x2d,
                    0x2d,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x55,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x30,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x49,
                    0x4e,
                    0x54,
                    0x52,
                    0x47,
                    0x42,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x56,
                    0x49,
                    0x53,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x30,
                    0x38,
                    0x52,
                    0x20,
                    // TODO: IGEOLO onwards
                    0x30,
                    // TODO: image comments
                    0x4e,
                    0x43,
                    // TODO: COMRAT onwards
                    // TODO: image segment body
                });
        Files.write(
                new File("imagesegment.nitf").toPath(),
                baos.toByteArray(),
                StandardOpenOption.CREATE);
    }

    @Test
    public void twoTextSegments() throws IOException {
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        TextSegment textSegment1 = new TextSegment();
        textSegment1.setIdentifier("TXT0001");
        textSegment1.setBody("AB");
        textSegment1.setDateTime(new JBPDateTime(20, 21, null, null, null, null, null));
        XMLDCA xmldca = new XMLDCA();
        // TODO: more properties, maybe more instances
        xmldca.setBody("<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<test/>");
        textSegment1.addExtension(xmldca);
        TextSegment textSegment2 = new TextSegment();
        textSegment2.setIdentifier("TXT0002");
        textSegment2.setDateTime(new JBPDateTime(20, 22, 10, 5, 23, 14, 1));
        textSegment2.setTitle("Segment 2 Title");
        textSegment2.setBody("C");
        Nitf testNitf = new Nitf();
        testNitf.addTextSegment(textSegment1);
        testNitf.addTextSegment(textSegment2);
        Writer writer = new Writer();
        writer.write(testNitf, baos);
        assertEquals(
                baos.toByteArray(),
                new byte[] {
                    0x4e,
                    0x49,
                    0x54,
                    0x46,
                    0x30,
                    0x32,
                    0x2e,
                    0x31,
                    0x30,
                    0x30,
                    0x33,
                    0x42,
                    0x46,
                    0x30,
                    0x31,
                    0x4a,
                    0x49,
                    0x4d,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x32,
                    0x30,
                    0x32,
                    0x32,
                    0x31,
                    0x30,
                    0x30,
                    0x36,
                    0x30,
                    0x36,
                    0x30,
                    0x36,
                    0x35,
                    0x34,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x55,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    (byte) 0xFF,
                    (byte) 0xFF,
                    (byte) 0xFF,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    // File size
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x31, // Offset 350
                    0x30,
                    0x33,
                    0x37,
                    // Header size
                    0x30,
                    0x30,
                    0x30,
                    0x34,
                    0x30,
                    0x36,
                    // Image segment count
                    0x30,
                    0x30,
                    0x30,
                    // Graphic segment count
                    0x30,
                    0x30,
                    0x30,
                    // Old symbol segment count
                    0x30,
                    0x30,
                    0x30,
                    // Text segment count
                    0x30,
                    0x30,
                    0x32,
                    // TODO: proper text segment sizes
                    // First text segment sizes
                    0x30,
                    0x33, // Offset 373
                    0x34,
                    0x36,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x32,
                    // Second text segment sizes
                    0x30,
                    0x32,
                    0x38,
                    0x32,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x31,
                    // DES count
                    0x30,
                    0x30,
                    0x30,
                    // Reserved segment count
                    0x30,
                    0x30,
                    0x30,
                    // User defined header
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    // Extended header
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    // Text segment #1 header and body
                    0x54,
                    0x45,
                    0x54,
                    0x58,
                    0x54,
                    0x30,
                    0x30,
                    0x30,
                    0x31,
                    0x30,
                    0x30,
                    0x30,
                    // TXTDT start
                    0x32,
                    0x30,
                    0x32,
                    0x31,
                    0x2d,
                    0x2d,
                    0x2d,
                    0x2d,
                    0x2d,
                    0x2d,
                    0x2d,
                    0x2d,
                    0x2d,
                    0x2d,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x55,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x30,
                    0x53,
                    0x54,
                    0x41,
                    0x30,
                    0x30,
                    0x30,
                    0x36,
                    0x34,
                    0x30,
                    0x30,
                    0x30,
                    0x58,
                    0x4d,
                    0x4c,
                    0x44,
                    0x43,
                    0x41,
                    0x30,
                    0x30,
                    0x30,
                    0x35, // offset 700
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x3c,
                    0x3f,
                    0X78,
                    0x6D,
                    0X6C,
                    0X20,
                    0X76,
                    0X65,
                    0X72,
                    0X73,
                    0X69,
                    0X6F,
                    0X6E,
                    0X3D,
                    0X22,
                    0X31,
                    0X2E,
                    0X30,
                    0X22,
                    0X20,
                    0X65,
                    0X6E,
                    0X63,
                    0X6F,
                    0X64,
                    0X69,
                    0X6E,
                    0X67,
                    0X3D,
                    0X22,
                    0X55,
                    0X54,
                    0X46,
                    0X2D,
                    0X38,
                    0X22,
                    0X3F,
                    0X3E,
                    0X0A,
                    0X3C,
                    0X74,
                    0X65,
                    0X73,
                    0X74,
                    0X2F,
                    0X3E,
                    0x41,
                    0x42,
                    // Text segment #2 header and body
                    0x54,
                    0x45,
                    0x54,
                    0x58,
                    0x54,
                    0x30,
                    0x30,
                    0x30,
                    0x32,
                    0x30,
                    0x30,
                    0x30,
                    // Date Time start
                    0x32,
                    0x30,
                    0x32,
                    0x32,
                    0x31,
                    0x30,
                    0x30,
                    0x35,
                    0x32,
                    0x33,
                    0x31,
                    0x34,
                    0x30,
                    0x31,
                    0x53,
                    0X65,
                    0X67,
                    0X6D,
                    0X65,
                    0X6E,
                    0X74,
                    0X20,
                    0X32,
                    0X20,
                    0X54,
                    0X69,
                    0X74,
                    0X6C,
                    0X65,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x55,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x30,
                    0x53,
                    0x54,
                    0x41,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x43,
                });
        Files.write(
                new File("twoTextSegments.nitf").toPath(),
                baos.toByteArray(),
                StandardOpenOption.CREATE);
    }

    @Test
    public void twoDataExtensionSegments() throws IOException {
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        Nitf testNitf = new Nitf();
        DataExtensionSegment des1 = new DataExtensionSegment();
        des1.setIdentifier("WBRD_FRAME");
        des1.setDesData("Some body content".getBytes(StandardCharsets.UTF_8));
        testNitf.addDataExtensionSegment(des1);
        DataExtensionSegment des2 = new DataExtensionSegment();
        des2.setIdentifier("WEATHER_DATA");
        des2.setVersion(4);
        des2.setDesData("Purple rain".getBytes(StandardCharsets.UTF_8));
        testNitf.addDataExtensionSegment(des2);
        Writer writer = new Writer();
        writer.write(testNitf, baos);
        assertEquals(
                baos.toByteArray(),
                new byte[] {
                    0x4e,
                    0x49,
                    0x54,
                    0x46,
                    0x30,
                    0x32,
                    0x2e,
                    0x31,
                    0x30,
                    0x30,
                    0x33,
                    0x42,
                    0x46,
                    0x30,
                    0x31,
                    0x4a,
                    0x49,
                    0x4d,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x32,
                    0x30,
                    0x32,
                    0x32,
                    0x31,
                    0x30,
                    0x30,
                    0x36,
                    0x30,
                    0x36,
                    0x30,
                    0x36,
                    0x35,
                    0x34,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x55,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    (byte) 0xFF,
                    (byte) 0xFF,
                    (byte) 0xFF,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    // File size
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30, // Offset 350
                    0x38,
                    0x34,
                    0x32,
                    // Header size
                    0x30,
                    0x30,
                    0x30,
                    0x34,
                    0x31,
                    0x34,
                    // Image segment count
                    0x30,
                    0x30,
                    0x30,
                    // Graphic segment count
                    0x30,
                    0x30,
                    0x30,
                    // Old symbol segment count
                    0x30,
                    0x30,
                    0x30,
                    // Text segment count
                    0x30,
                    0x30,
                    0x30,
                    // DES count
                    0x30,
                    0x30,
                    0x32,
                    // DES lengths
                    0x30, // offset 375
                    0x32,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x31,
                    0x37,
                    0x30,
                    0x32,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x31,
                    0x31,
                    // Reserved segment count
                    0x30,
                    0x30,
                    0x30,
                    // User defined header
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    // Extended header
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    // DES #1
                    0x44,
                    0x45,
                    0x57,
                    0x42,
                    0x52,
                    0x44,
                    0x5f,
                    0x46,
                    0x52,
                    0x41,
                    0x4d,
                    0x45,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x30,
                    0x31,
                    0x55,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x53,
                    0x6f,
                    0x6d,
                    0x65,
                    0x20,
                    0x62,
                    0x6f,
                    0x64,
                    0x79,
                    0x20,
                    0x63,
                    0x6f,
                    0x6e,
                    0x74,
                    0x65,
                    0x6e,
                    0x74,
                    // DES #2
                    0x44,
                    0x45,
                    0x57,
                    0x45,
                    0x41,
                    0x54,
                    0x48,
                    0x45,
                    0x52,
                    0x5F,
                    0x44,
                    0x41,
                    0x54,
                    0x41,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x30,
                    0x34,
                    0x55,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x20,
                    0x30,
                    0x30,
                    0x30,
                    0x30,
                    0x50,
                    0x75,
                    0x72,
                    0x70,
                    0x6c,
                    0x65,
                    0x20,
                    0x72,
                    0x61,
                    0x69,
                    0x6e
                });
        Files.write(
                new File("twoDataExtensionSegments.nitf").toPath(),
                baos.toByteArray(),
                StandardOpenOption.CREATE);
    }
}
